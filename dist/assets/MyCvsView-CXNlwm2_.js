import{d as K,r as g,q as R,c as a,a as t,i as j,b as c,t as m,h as f,e as d,f as u,B,F as M,g as V,z as G,m as D,u as J,w as z,K as Q,o as r}from"./index-GVITuUF_.js";import{u as W}from"./cv-DT3822Ms.js";import{_ as y}from"./BaseButton.vue_vue_type_script_setup_true_lang-D9fM7hcV.js";import{_ as $}from"./BaseCard.vue_vue_type_script_setup_true_lang-B9cdWWyn.js";import{_ as X}from"./BaseBadge.vue_vue_type_script_setup_true_lang-DEzl8sK-.js";import{_ as P}from"./BaseModal.vue_vue_type_script_setup_true_lang-CMC_pA0B.js";const Z={class:"container-custom py-8"},ee={class:"flex items-center justify-between mb-8"},te={class:"text-gray-600"},oe={key:0,class:"text-sm text-red-600 mt-2"},se={key:0,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},re={key:2,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},le={class:"p-6 flex flex-col h-full"},ae={key:0,class:"absolute top-4 right-4"},ne={class:"mb-4 flex-shrink-0"},ie={class:"flex items-start gap-4 mb-3"},de={class:"w-16 h-16 bg-gray-100 rounded-full overflow-hidden flex-shrink-0 flex items-center justify-center ring-2 ring-gray-200 group-hover:ring-primary-300 transition-all duration-300"},ue=["src","alt"],ce={key:1,class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},me={class:"flex-1 min-w-0"},pe={class:"text-xl font-bold text-gray-900 mb-1 truncate group-hover:text-primary-600 transition-colors"},ve={class:"text-primary-600 font-medium mb-2 truncate"},ge={class:"text-sm text-gray-600 truncate"},fe={class:"flex items-center gap-4 text-xs text-gray-500"},ye={class:"flex items-center gap-1"},he={key:0,class:"flex items-center gap-1 text-green-600"},xe={key:1,class:"flex items-center gap-1 text-gray-500"},ke={class:"flex-1 min-h-0 mb-4"},we={key:0,class:"text-sm text-gray-600 line-clamp-3"},Ce={class:"flex-shrink-0 mb-4 h-14 overflow-hidden"},be={key:0,class:"flex flex-wrap gap-2"},_e={key:0,class:"px-2 py-1 text-gray-500 text-xs"},Me={class:"flex gap-2 pt-4 border-t border-gray-200 flex-shrink-0"},Ve=["onClick"],ze={class:"space-y-2"},je={key:0,class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Be={key:1,class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},De={class:"font-medium text-gray-900"},$e={class:"flex gap-3"},Le=K({__name:"MyCvsView",setup(Pe){const x=J(),k=W(),w=Q(),b=g(!1),_=g(!1),p=g(!1),h=g(!1),n=g(null),C=g([]),i=g([]),F=s=>{const e=new Date,o=new Date(s),v=Math.abs(e.getTime()-o.getTime()),l=Math.ceil(v/(1e3*60*60*24));return l===0?"today":l===1?"yesterday":l<7?`${l} days ago`:l<30?`${Math.floor(l/7)} weeks ago`:l<365?`${Math.floor(l/30)} months ago`:`${Math.floor(l/365)} years ago`},N=async()=>{b.value=!0;try{await k.fetchMyCvs(),i.value=k.myCvs}catch(s){console.error("Failed to load CVs:",s)}finally{b.value=!1}},S=()=>{if(i.value.length>=6){w.error("You have reached the maximum number of CVs (6). Please delete an existing CV before creating a new one.");return}x.push("/my-cvs/create")},I=s=>{const e=C.value.indexOf(s.id);e>-1?C.value.splice(e,1):C.value.push(s.id)},A=s=>{if(console.log("viewCv called with:",s),console.log("CV ID:",s.id),!s.id){console.error("CV does not have an ID:",s),w.error("This CV cannot be viewed. Please try refreshing the page.");return}console.log("Navigating to CV with ID:",s.id),x.push(`/my-cvs/view/${s.id}`)},H=s=>{n.value=s,p.value=!0},L=async()=>{try{i.value.forEach(s=>{var e;s.is_primary=s.id===((e=n.value)==null?void 0:e.id)}),p.value=!1}catch(s){console.error("Failed to set primary CV:",s)}},T=async()=>{try{const s=i.value.find(e=>{var o;return e.id===((o=n.value)==null?void 0:o.id)});s&&(s.is_public=!s.is_public),p.value=!1}catch(s){console.error("Failed to toggle public status:",s)}},E=async()=>{try{if(n.value){const s={...n.value,id:i.value.length+1,full_name:`${n.value.full_name} (Copy)`,is_primary:!1,slug:`${n.value.slug}-copy-${Date.now()}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};i.value.unshift(s)}p.value=!1}catch(s){console.error("Failed to duplicate CV:",s)}},O=async()=>{try{console.log("Downloading CV:",n.value),alert("PDF download feature coming soon!"),p.value=!1}catch(s){console.error("Failed to download CV:",s)}},U=()=>{p.value=!1,h.value=!0},Y=async()=>{var s,e;_.value=!0;try{n.value&&(await k.deleteCv(n.value.id),i.value=k.myCvs,w.success("CV deleted successfully!")),h.value=!1,n.value=null}catch(o){console.error("Failed to delete CV:",o),w.error(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to delete CV. Please try again.")}finally{_.value=!1}};return R(()=>{N()}),(s,e)=>(r(),a("div",Z,[t("div",ee,[t("div",null,[e[4]||(e[4]=t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"My CVs",-1)),t("p",te,"Create and manage your professional CVs ("+m(i.value.length)+"/6)",1)]),t("div",null,[c(y,{variant:"primary",size:"lg",onClick:S,disabled:i.value.length>=6,class:B({"opacity-50 cursor-not-allowed":i.value.length>=6})},{default:d(()=>[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Create New CV ",-1)])]),_:1},8,["disabled","class"]),i.value.length>=6?(r(),a("p",oe,"Maximum CV limit reached (6/6)")):f("",!0)])]),b.value?(r(),a("div",se,[(r(),a(M,null,V(3,o=>t("div",{key:o,class:"bg-white rounded-lg border border-gray-200 p-6"},[...e[6]||(e[6]=[G('<div class="animate-pulse"><div class="h-6 bg-gray-200 rounded w-3/4 mb-4"></div><div class="h-4 bg-gray-200 rounded w-1/2 mb-6"></div><div class="space-y-2 mb-4"><div class="h-3 bg-gray-200 rounded"></div><div class="h-3 bg-gray-200 rounded"></div></div><div class="flex gap-2"><div class="h-8 bg-gray-200 rounded w-20"></div><div class="h-8 bg-gray-200 rounded w-20"></div></div></div>',1)])])),64))])):i.value.length===0?(r(),j($,{key:1,class:"p-12 text-center"},{default:d(()=>[e[8]||(e[8]=t("svg",{class:"h-16 w-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[9]||(e[9]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"No CVs yet",-1)),e[10]||(e[10]=t("p",{class:"text-gray-600 mb-6"},"Create your first CV to start applying for jobs",-1)),c(y,{variant:"primary",onClick:e[0]||(e[0]=o=>D(x).push("/my-cvs/create"))},{default:d(()=>[...e[7]||(e[7]=[u(" Create Your First CV ",-1)])]),_:1})]),_:1})):(r(),a("div",re,[(r(!0),a(M,null,V(i.value,o=>(r(),j($,{key:o.id,class:B(["relative h-[420px] flex flex-col border-2 border-gray-200 hover:border-primary-500 hover:shadow-lg transition-all duration-300 cursor-pointer group",{"ring-2 ring-primary-500 border-primary-500":C.value.includes(o.id)}]),onClick:v=>I(o)},{default:d(()=>{var v;return[t("div",le,[o.is_primary?(r(),a("div",ae,[c(X,{variant:"primary",size:"sm"},{default:d(()=>[...e[11]||(e[11]=[t("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),u(" Primary ",-1)])]),_:1})])):f("",!0),t("div",ne,[t("div",ie,[t("div",de,[o.profileImage||o.profile_image?(r(),a("img",{key:0,src:`/storage/${(v=o.profileImage||o.profile_image)==null?void 0:v.path}`,alt:o.full_name,class:"w-full h-full object-cover"},null,8,ue)):(r(),a("svg",ce,[...e[12]||(e[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])]))]),t("div",me,[t("h3",pe,m(o.full_name),1),t("p",ve,m(o.title||"No title"),1),t("p",ge,m(o.email),1)])]),t("div",fe,[t("span",ye,[e[13]||(e[13]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),u(" Updated "+m(F(o.updated_at)),1)]),o.is_public?(r(),a("span",he,[...e[14]||(e[14]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),u(" Public ",-1)])])):(r(),a("span",xe,[...e[15]||(e[15]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})],-1),u(" Private ",-1)])]))])]),t("div",ke,[o.summary?(r(),a("p",we,m(o.summary),1)):f("",!0)]),t("div",Ce,[o.skills&&o.skills.length>0?(r(),a("div",be,[(r(!0),a(M,null,V(o.skills.slice(0,3),(l,q)=>(r(),a("span",{key:q,class:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium group-hover:bg-primary-50 group-hover:text-primary-700 transition-colors"},m(typeof l=="string"?l:l.name),1))),128)),o.skills.length>3?(r(),a("span",_e," +"+m(o.skills.length-3)+" more ",1)):f("",!0)])):f("",!0)]),t("div",Me,[c(y,{variant:"outline",size:"sm",onClick:z(l=>A(o),["stop"]),class:"flex-1 cursor-pointer hover:border-primary-500 hover:text-primary-600 hover:bg-primary-50 hover:scale-105 transform transition-all duration-200 active:scale-95"},{default:d(()=>[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),u(" View ",-1)])]),_:1},8,["onClick"]),c(y,{variant:"primary",size:"sm",onClick:z(l=>D(x).push(`/my-cvs/edit/${o.id}`),["stop"]),class:"flex-1 cursor-pointer hover:bg-primary-700 hover:scale-105 hover:shadow-lg transform transition-all duration-200 active:scale-95"},{default:d(()=>[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),u(" Edit ",-1)])]),_:1},8,["onClick"]),t("button",{onClick:z(l=>H(o),["stop"]),class:"px-3 py-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 hover:scale-110 rounded-lg transform transition-all duration-200 cursor-pointer active:scale-95"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})],-1)])],8,Ve)])])]}),_:2},1032,["class","onClick"]))),128))])),c(P,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),title:"CV Actions",size:"sm"},{default:d(()=>{var o,v,l;return[t("div",ze,[(o=n.value)!=null&&o.is_primary?f("",!0):(r(),a("button",{key:0,onClick:L,class:"w-full px-4 py-3 text-left hover:bg-gray-50 rounded-lg transition-colors flex items-center gap-3"},[...e[19]||(e[19]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1),t("span",{class:"font-medium text-gray-900"},"Set as Primary",-1)])])),t("button",{onClick:T,class:"w-full px-4 py-3 text-left hover:bg-gray-50 rounded-lg transition-colors flex items-center gap-3"},[(v=n.value)!=null&&v.is_public?(r(),a("svg",je,[...e[20]||(e[20]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(r(),a("svg",Be,[...e[21]||(e[21]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])])),t("span",De,m((l=n.value)!=null&&l.is_public?"Make Private":"Make Public"),1)]),t("button",{onClick:E,class:"w-full px-4 py-3 text-left hover:bg-gray-50 rounded-lg transition-colors flex items-center gap-3"},[...e[22]||(e[22]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),t("span",{class:"font-medium text-gray-900"},"Duplicate",-1)])]),t("button",{onClick:O,class:"w-full px-4 py-3 text-left hover:bg-gray-50 rounded-lg transition-colors flex items-center gap-3"},[...e[23]||(e[23]=[t("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("span",{class:"font-medium text-gray-900"},"Download PDF",-1)])]),t("button",{onClick:U,class:"w-full px-4 py-3 text-left hover:bg-red-50 rounded-lg transition-colors flex items-center gap-3 text-red-600"},[...e[24]||(e[24]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),t("span",{class:"font-medium"},"Delete CV",-1)])])])]}),_:1},8,["modelValue"]),c(P,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=o=>h.value=o),title:"Delete CV",size:"sm"},{default:d(()=>[e[27]||(e[27]=t("div",{class:"mb-6"},[t("p",{class:"text-gray-600"},"Are you sure you want to delete this CV? This action cannot be undone.")],-1)),t("div",$e,[c(y,{type:"button",variant:"outline",onClick:e[2]||(e[2]=o=>h.value=!1),class:"flex-1"},{default:d(()=>[...e[25]||(e[25]=[u(" Cancel ",-1)])]),_:1}),c(y,{type:"button",variant:"danger",onClick:Y,loading:_.value,class:"flex-1"},{default:d(()=>[...e[26]||(e[26]=[u(" Delete ",-1)])]),_:1},8,["loading"])])]),_:1},8,["modelValue"])]))}});export{Le as default};
