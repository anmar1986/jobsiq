import{E as d,G as M,r as f}from"./index-GVITuUF_.js";const i={async getCvs(c){return(await d.get("/cvs",{params:c})).data},async getCv(c){return(await d.get(`/my-cvs/${c}`)).data},async getMyCvs(){return(await d.get("/my-cvs")).data},async createCv(c){return(await d.post("/my-cvs",c)).data},async createCvWithFormData(c){return(await d.post("/my-cvs",c,{headers:{"Content-Type":void 0}})).data},async updateCv(c,t){const v=new FormData;return Object.keys(t).forEach(u=>{t[u]!==null&&t[u]!==void 0&&(Array.isArray(t[u])||typeof t[u]=="object"?v.append(u,JSON.stringify(t[u])):v.append(u,String(t[u])))}),(await d.post(`/my-cvs/${c}`,v,{headers:{"Content-Type":void 0}})).data},async updateCvWithFormData(c,t){return(await d.post(`/my-cvs/${c}`,t,{headers:{"Content-Type":void 0}})).data},async deleteCv(c){return(await d.delete(`/my-cvs/${c}`)).data}},T=M("cv",()=>{const c=f([]),t=f([]),v=f(null),y=f(null),u=f({search:"",skills:"",location:"",per_page:15,page:1}),l=f(!1),o=f(null);async function g(n){var s,a;try{l.value=!0,o.value=null;const e={...u.value,...n},r=await i.getCvs(e);if(r.success&&r.data){const{data:p,...C}=r.data;c.value=p,y.value=C}}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch CVs",e}finally{l.value=!1}}async function h(n){var s,a;try{l.value=!0,o.value=null;const e=await i.getCv(n);e.success&&e.data&&(v.value=e.data)}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch CV",e}finally{l.value=!1}}async function m(n){var s,a;try{l.value=!0,o.value=null;const e=await i.getCv(n);e.success&&e.data&&(v.value=e.data)}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch CV",e}finally{l.value=!1}}async function w(){var n,s;try{l.value=!0,o.value=null;const a=await i.getMyCvs();console.log("Fetch My CVs Response:",a),a.success&&a.data&&(console.log("My CVs data:",a.data),a.data.forEach((e,r)=>{console.log(`CV ${r} - ID: ${e.id}, Slug: ${e.slug}, Title: ${e.title}`)}),t.value=a.data)}catch(a){throw o.value=((s=(n=a.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to fetch CVs",a}finally{l.value=!1}}async function F(n){var s,a;try{l.value=!0,o.value=null;const e=await i.createCv(n);if(console.log("Create CV Response:",e),e.success&&e.data)return console.log("Created CV data:",e.data),console.log("Created CV slug:",e.data.slug),t.value.unshift(e.data),e.data}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to create CV",e}finally{l.value=!1}}async function V(n){var s,a;try{l.value=!0,o.value=null;const e=await i.createCvWithFormData(n);if(console.log("Create CV Response:",e),e.success&&e.data)return console.log("Created CV data:",e.data),console.log("Created CV slug:",e.data.slug),t.value.unshift(e.data),e.data}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to create CV",e}finally{l.value=!1}}async function D(n,s){var a,e;try{l.value=!0,o.value=null;const r=await i.updateCv(n,s);if(r.success&&r.data){const p=t.value.findIndex(C=>C.id===n);return p!==-1&&(t.value[p]=r.data),r.data}}catch(r){throw o.value=((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to update CV",r}finally{l.value=!1}}async function $(n,s){var a,e;try{l.value=!0,o.value=null;const r=await i.updateCvWithFormData(n,s);if(r.success&&r.data){const p=t.value.findIndex(C=>C.id===n);return p!==-1&&(t.value[p]=r.data),r.data}}catch(r){throw o.value=((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to update CV",r}finally{l.value=!1}}async function S(n){var s,a;try{l.value=!0,o.value=null,(await i.deleteCv(n)).success&&(t.value=t.value.filter(r=>r.id!==n))}catch(e){throw o.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete CV",e}finally{l.value=!1}}function W(n){u.value={...u.value,...n}}function x(){u.value={search:"",skills:"",location:"",per_page:15,page:1}}return{cvs:c,myCvs:t,currentCv:v,pagination:y,filters:u,loading:l,error:o,fetchCvs:g,fetchCv:h,fetchCvById:m,fetchMyCvs:w,createCv:F,createCvWithFormData:V,updateCv:D,updateCvWithFormData:$,deleteCv:S,updateFilters:W,resetFilters:x}});export{T as u};
